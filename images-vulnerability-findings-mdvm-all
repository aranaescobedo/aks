SecurityResources
| where type =~ "microsoft.security/assessments/subassessments" and id has "c0b7cfc6-3172-465a-b378-53c7ff2cc0d5" //the ID of the assessment - Container registry images should have vulnerability findings resolved (powered by Microsoft Defender Vulnerability Management)-Preview
| extend
    status = properties.status.code,
    registryHost = parse_json(properties.additionalData.artifactDetails.registryHost),
    repoName = properties.additionalData.artifactDetails.repositoryName,
    severity = tostring(properties.status.severity)
| where 
    status == "Unhealthy" //and repoName contains "<ADD_YOUR_REPO_NAME_TO_FILTER>"
| extend
    imageDigest = properties.additionalData.artifactDetails.digest,
    lastModified = todatetime(properties.timeGenerated),
    repositoryName = properties.additionalData.artifactDetails.repositoryName,
    high = iff(severity == "High", 3,0), medium = iff(severity == "Medium", 2, 0), low = iff(severity == "Low", 1 ,0)
| extend all = high + medium + low, lastModifiedDate = format_datetime(lastModified, 'yyyy-MM-dd')
| order by all desc, lastModifiedDate
| project ACRName = registryHost,
    RepositoryName = repositoryName,
    ImageDigest = imageDigest,
    LastModified = lastModifiedDate,
    Severity = severity,
    Name = properties.displayName,
    Description = properties.description,
    Remediation = properties.remediation
